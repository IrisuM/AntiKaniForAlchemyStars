# 关于荒典显示错误的一些分析

## 前提说明

把这篇分析放在这个git上，只是想增加一点说服力，免得有些人说我凭空洗白。

有些人说显示错误不可能导致排行榜奖励等比例变化，我只能说，估摸着这些人不是当程序员的，至少没写过大堆的工程，奖励内容这种一眼配置文件的东西，很容易犯错。

看完下面的分析，再来和我说说等比例奖励有多么多么可能发生，多么多么洗不白吧。

注意，下面包含大量代码数据，不懂得直接跳过看文字就行。

## 先说说荒典排行榜奖励内容是怎么设置的

先来看看这个数据表，这个数据表提取自cfg_world_boss_dan文件，有分析能力的人可以在这个文件中验证我的说法。

```lua
  {

    1034,

    1100,

    7001094,

    4000000,

    2000,

    40014,

    common[21],

    common[52],

    common[53],

    common[54]

  }
```

这里截取的就是本次荒典最高段位的奖励，我们再来看看修复之前的。

```lua
  {

    1034,

    1100,

    7001094,

    4000000,

    2000,

    40014,

    common[11],

    common[52],

    common[53],

    common[54]

  }
```

让我们看看这些数据项代表什么意思：

```lua
local key = {

  ID = 1,

  DanLevel = 2,

  MissionID = 3,

  NeedDamage = 4,

  RankLevel = 5,

  MailID = 6,

  Rewards = 7,

  DanName = 8,

  DanBadgeBase = 9,

  SimpleDanBadgeBase = 10,

  IsPlusDan = 11

}
```

其中的区别就是代表奖励Rewards的配置项common序号变化，从11修复为了21，那我们再看看这里的common[11]和common[21]是什么吧

```lua
--common[11]
  {

    {3000003, 200},

    {3000025, 5},

    {3000026, 600}

  }

--common[21]
  {

    {3000003, 300},

    {3000025, 5},

    {3000026, 600}

  }
```

有没有觉得这些数字有点眼熟？没错，和荒典的奖励数量是一样的，我们看看关键的300光珀，也就是物品编号3000003，验证是否正确。

```lua
local config = {

  str_item_3000001 = "棱镜",

  str_item_3000002 = "白夜币",

  str_item_3000003 = "光珀",

  str_item_3000004 = "指挥经验",

  str_item_3000005 = "萤盏",

  str_item_3000006 = "趋光值",

  str_item_3000007 = "旧卷碎片",

  str_item_3000008 = "活跃度",

  str_item_3000009 = "成就积分",

  --后略
}
```

没错，奖励项也确认了。

那么我们总结一下，荒典的奖励是由一张包含伤害、荒典ID等等信息的table决定的，而造成奖励变化的原因就是这张表里面对于奖励的索引id发生了异常。

## 再谈谈这次的异常

纵向比较一下，我们看看这次奖励异常的荒典和上一期荒典的数据表。

```lua
{

    1013,

    100,

    7001093,

    100000,

    0,

    40001,

    common[1],

    common[22],

    common[23],

    common[24]

  },

  {

    1014,

    200,

    7001093,

    200000,

    0,

    40003,

    common[12],

    common[25],

    common[26],

    common[27]

  },

  {

    1015,

    300,

    7001093,

    300000,

    0,

    40004,

    common[13],

    common[28],

    common[29],

    common[30],

    1

  },

  {

    1016,

    400,

    7001093,

    400000,

    0,

    40005,

    common[14],

    common[31],

    common[32],

    common[33]

  },

  {

    1017,

    500,

    7001093,

    600000,

    0,

    40006,

    common[15],

    common[34],

    common[35],

    common[36],

    1

  },

  {

    1018,

    600,

    7001093,

    800000,

    0,

    40007,

    common[16],

    common[37],

    common[38],

    common[39]

  },

  {

    1019,

    700,

    7001093,

    1050000,

    0,

    40008,

    common[17],

    common[40],

    common[41],

    common[42],

    1

  },

  {

    1020,

    800,

    7001093,

    1300000,

    0,

    40011,

    common[18],

    common[43],

    common[44],

    common[45]

  },

  {

    1021,

    900,

    7001093,

    1600000,

    0,

    40012,

    common[19],

    common[46],

    common[47],

    common[48],

    1

  },

  {

    1022,

    1000,

    7001093,

    1900000,

    0,

    40013,

    common[20],

    common[49],

    common[50],

    common[51]

  },

  {

    1023,

    1100,

    7001093,

    1900000,

    2000,

    40014,

    common[21],

    common[52],

    common[53],

    common[54]

  },
-- 分界线-------------------------------------------------------------------
  {

    1024,

    100,

    7001094,

    300000,

    0,

    40001,

    common[1],

    common[22],

    common[23],

    common[24]

  },

  {

    1025,

    200,

    7001094,

    600000,

    0,

    40003,

    common[2],

    common[25],

    common[26],

    common[27]

  },

  {

    1026,

    300,

    7001094,

    900000,

    0,

    40004,

    common[3],

    common[28],

    common[29],

    common[30],

    1

  },

  {

    1027,

    400,

    7001094,

    1200000,

    0,

    40005,

    common[4],

    common[31],

    common[32],

    common[33]

  },

  {

    1028,

    500,

    7001094,

    1600000,

    0,

    40006,

    common[5],

    common[34],

    common[35],

    common[36],

    1

  },

  {

    1029,

    600,

    7001094,

    2000000,

    0,

    40007,

    common[6],

    common[37],

    common[38],

    common[39]

  },

  {

    1030,

    700,

    7001094,

    2500000,

    0,

    40008,

    common[7],

    common[40],

    common[41],

    common[42],

    1

  },

  {

    1031,

    800,

    7001094,

    3000000,

    0,

    40011,

    common[8],

    common[43],

    common[44],

    common[45]

  },

  {

    1032,

    900,

    7001094,

    3500000,

    0,

    40012,

    common[9],

    common[46],

    common[47],

    common[48],

    1

  },

  {

    1033,

    1000,

    7001094,

    4000000,

    0,

    40013,

    common[10],

    common[49],

    common[50],

    common[51]

  },

  {

    1034,

    1100,

    7001094,

    4000000,

    2000,

    40014,

    common[11],

    common[52],

    common[53],

    common[54]

  }
```

看出什么问题没有？正常的数据项是从1开始，然后直接10、11再数到21的，而异常的是从1正常地数到11。

抛开偏见，你就说这东西是不是反直觉吧，万一那天不小心或者来个新人，有没有可能配置错吧。

## 最后再提前堵一下可能反驳我的点

万一有人说，“啊，为什么有一些没用到的奖励配置？不用想肯定是藤子试探底线，打算偷偷改所以提前加上去的，一眼尬洗，藤子嘴脸暴露无遗”

我只想说，对于程序员来讲，能增量更新就绝对不删改已有的数据项，天知道哪里还会复用，到时候删了报一堆错你负责吗？

当然，光谈程序员习惯肯定很多人不会相信的，那就拿点实证，看看外服数据，我随便抽一期荒典，我也不知道是哪一期。

```lua
  {

    1211,

    100,

    7001111,

    100000,

    0,

    40001,

    common[9],

    common[20],

    common[21],

    common[22]

  },

  {

    1212,

    200,

    7001111,

    200000,

    0,

    40003,

    common[10],

    common[23],

    common[24],

    common[25]

  },

  {

    1213,

    300,

    7001111,

    400000,

    0,

    40004,

    common[11],

    common[26],

    common[27],

    common[28],

    1

  },

  {

    1214,

    400,

    7001111,

    600000,

    0,

    40005,

    common[12],

    common[29],

    common[30],

    common[31]

  },

  {

    1215,

    500,

    7001111,

    800000,

    0,

    40006,

    common[13],

    common[32],

    common[33],

    common[34],

    1

  },

  {

    1216,

    600,

    7001111,

    1000000,

    0,

    40007,

    common[14],

    common[35],

    common[36],

    common[37]

  },

  {

    1217,

    700,

    7001111,

    1400000,

    0,

    40008,

    common[15],

    common[38],

    common[39],

    common[40],

    1

  },

  {

    1218,

    800,

    7001111,

    1800000,

    0,

    40011,

    common[16],

    common[41],

    common[42],

    common[43]

  },

  {

    1219,

    900,

    7001111,

    2400000,

    0,

    40012,

    common[17],

    common[44],

    common[45],

    common[46],

    1

  },

  {

    1220,

    1000,

    7001111,

    3000000,

    0,

    40013,

    common[18],

    common[47],

    common[48],

    common[49]

  },

  {

    1221,

    1100,

    7001111,

    3000000,

    999,

    40014,

    common[19],

    common[50],

    common[51],

    common[52]

  }
```

从9数到19，没有任何道理的，硬要解释就是历史遗留问题，开发过程留下的石山代码。

## 最后

讲道理，真的会有正常人会在已经有梦境难度问题的时候还搞出降奖励这种必报舆情的操作吗？

我是很不理解那些说锤死必不可能是代码BUG一定是策划作死的人的，是不是代码BUG，上手看一眼的事情，怎么就宁可论坛上闭上眼睛跟着节奏喷一天也不自己去看一眼呢？

有人说完全有可能是主观设置，人为犯错的可能性很低，那我给你看看这个配置文件里面前面的数据。

除了最近的几期荒典是正确配置，前面都是错误的，记住，第一项是编号，荒典配置数据项是从1开始，一共1221项数据里面只有最近几期991-1023按照正常数据来写，你说犯错的可能性大不大，我估摸着就是漏改了。

```lua

  {

    947,

    100,

    7001087,

    800000,

    0,

    40001,

    common[1],

    common[22],

    common[23],

    common[24]

  },

  {

    948,

    200,

    7001087,

    1600000,

    0,

    40003,

    common[2],

    common[25],

    common[26],

    common[27]

  },

  {

    949,

    300,

    7001087,

    2400000,

    0,

    40004,

    common[3],

    common[28],

    common[29],

    common[30],

    1

  },

  {

    950,

    400,

    7001087,

    3200000,

    0,

    40005,

    common[4],

    common[31],

    common[32],

    common[33]

  },

  {

    951,

    500,

    7001087,

    4000000,

    0,

    40006,

    common[5],

    common[34],

    common[35],

    common[36],

    1

  },

  {

    952,

    600,

    7001087,

    5000000,

    0,

    40007,

    common[6],

    common[37],

    common[38],

    common[39]

  },

  {

    953,

    700,

    7001087,

    6000000,

    0,

    40008,

    common[7],

    common[40],

    common[41],

    common[42],

    1

  },

  {

    954,

    800,

    7001087,

    7000000,

    0,

    40011,

    common[8],

    common[43],

    common[44],

    common[45]

  },

  {

    955,

    900,

    7001087,

    8500000,

    0,

    40012,

    common[9],

    common[46],

    common[47],

    common[48],

    1

  },

  {

    956,

    1000,

    7001087,

    10000000,

    0,

    40013,

    common[10],

    common[49],

    common[50],

    common[51]

  },

  {

    957,

    1100,

    7001087,

    10000000,

    2000,

    40014,

    common[11],

    common[52],

    common[53],

    common[54]

  },

  {

    958,

    100,

    7001088,

    500000,

    0,

    40001,

    common[1],

    common[22],

    common[23],

    common[24]

  },

  {

    959,

    200,

    7001088,

    1000000,

    0,

    40003,

    common[2],

    common[25],

    common[26],

    common[27]

  },

  {

    960,

    300,

    7001088,

    1500000,

    0,

    40004,

    common[3],

    common[28],

    common[29],

    common[30],

    1

  },

  {

    961,

    400,

    7001088,

    2000000,

    0,

    40005,

    common[4],

    common[31],

    common[32],

    common[33]

  },

  {

    962,

    500,

    7001088,

    2500000,

    0,

    40006,

    common[5],

    common[34],

    common[35],

    common[36],

    1

  },

  {

    963,

    600,

    7001088,

    3000000,

    0,

    40007,

    common[6],

    common[37],

    common[38],

    common[39]

  },

  {

    964,

    700,

    7001088,

    3500000,

    0,

    40008,

    common[7],

    common[40],

    common[41],

    common[42],

    1

  },

  {

    965,

    800,

    7001088,

    4000000,

    0,

    40011,

    common[8],

    common[43],

    common[44],

    common[45]

  },

  {

    966,

    900,

    7001088,

    5000000,

    0,

    40012,

    common[9],

    common[46],

    common[47],

    common[48],

    1

  },

  {

    967,

    1000,

    7001088,

    6000000,

    0,

    40013,

    common[10],

    common[49],

    common[50],

    common[51]

  },

  {

    968,

    1100,

    7001088,

    6000000,

    2000,

    40014,

    common[11],

    common[52],

    common[53],

    common[54]

  },


  {

    969,

    100,

    7001089,

    500000,

    0,

    40001,

    common[1],

    common[22],

    common[23],

    common[24]

  },

  {

    970,

    200,

    7001089,

    1000000,

    0,

    40003,

    common[2],

    common[25],

    common[26],

    common[27]

  },

  {

    971,

    300,

    7001089,

    1500000,

    0,

    40004,

    common[3],

    common[28],

    common[29],

    common[30],

    1

  },

  {

    972,

    400,

    7001089,

    2000000,

    0,

    40005,

    common[4],

    common[31],

    common[32],

    common[33]

  },

  {

    973,

    500,

    7001089,

    2500000,

    0,

    40006,

    common[5],

    common[34],

    common[35],

    common[36],

    1

  },

  {

    974,

    600,

    7001089,

    3000000,

    0,

    40007,

    common[6],

    common[37],

    common[38],

    common[39]

  },

  {

    975,

    700,

    7001089,

    3500000,

    0,

    40008,

    common[7],

    common[40],

    common[41],

    common[42],

    1

  },

  {

    976,

    800,

    7001089,

    4000000,

    0,

    40011,

    common[8],

    common[43],

    common[44],

    common[45]

  },

  {

    977,

    900,

    7001089,

    5000000,

    0,

    40012,

    common[9],

    common[46],

    common[47],

    common[48],

    1

  },

  {

    978,

    1000,

    7001089,

    6000000,

    0,

    40013,

    common[10],

    common[49],

    common[50],

    common[51]

  },

  {

    979,

    1100,

    7001089,

    6000000,

    2000,

    40014,

    common[11],

    common[52],

    common[53],

    common[54]

  },

  {

    980,

    100,

    7001090,

    50000,

    0,

    40001,

    common[1],

    common[22],

    common[23],

    common[24]

  },

  {

    981,

    200,

    7001090,

    100000,

    0,

    40003,

    common[2],

    common[25],

    common[26],

    common[27]

  },

  {

    982,

    300,

    7001090,

    200000,

    0,

    40004,

    common[3],

    common[28],

    common[29],

    common[30],

    1

  },

  {

    983,

    400,

    7001090,

    300000,

    0,

    40005,

    common[4],

    common[31],

    common[32],

    common[33]

  },

  {

    984,

    500,

    7001090,

    400000,

    0,

    40006,

    common[5],

    common[34],

    common[35],

    common[36],

    1

  },

  {

    985,

    600,

    7001090,

    500000,

    0,

    40007,

    common[6],

    common[37],

    common[38],

    common[39]

  },

  {

    986,

    700,

    7001090,

    700000,

    0,

    40008,

    common[7],

    common[40],

    common[41],

    common[42],

    1

  },

  {

    987,

    800,

    7001090,

    900000,

    0,

    40011,

    common[8],

    common[43],

    common[44],

    common[45]

  },

  {

    988,

    900,

    7001090,

    1200000,

    0,

    40012,

    common[9],

    common[46],

    common[47],

    common[48],

    1

  },

  {

    989,

    1000,

    7001090,

    1500000,

    0,

    40013,

    common[10],

    common[49],

    common[50],

    common[51]

  },

  {

    990,

    1100,

    7001090,

    1500000,

    2000,

    40014,

    common[11],

    common[52],

    common[53],

    common[54]

  },

  {

    991,

    100,

    7001091,

    500000,

    0,

    40001,

    common[1],

    common[22],

    common[23],

    common[24]

  },

  {

    992,

    200,

    7001091,

    1000000,

    0,

    40003,

    common[12],

    common[25],

    common[26],

    common[27]

  },

  {

    993,

    300,

    7001091,

    1500000,

    0,

    40004,

    common[13],

    common[28],

    common[29],

    common[30],

    1

  },

  {

    994,

    400,

    7001091,

    2000000,

    0,

    40005,

    common[14],

    common[31],

    common[32],

    common[33]

  },

  {

    995,

    500,

    7001091,

    2500000,

    0,

    40006,

    common[15],

    common[34],

    common[35],

    common[36],

    1

  },

  {

    996,

    600,

    7001091,

    3000000,

    0,

    40007,

    common[16],

    common[37],

    common[38],

    common[39]

  },

  {

    997,

    700,

    7001091,

    3500000,

    0,

    40008,

    common[17],

    common[40],

    common[41],

    common[42],

    1

  },

  {

    998,

    800,

    7001091,

    4000000,

    0,

    40011,

    common[18],

    common[43],

    common[44],

    common[45]

  },

  {

    999,

    900,

    7001091,

    4500000,

    0,

    40012,

    common[19],

    common[46],

    common[47],

    common[48],

    1

  },

  {

    1000,

    1000,

    7001091,

    5000000,

    0,

    40013,

    common[20],

    common[49],

    common[50],

    common[51]

  },

  {

    1001,

    1100,

    7001091,

    5000000,

    2000,

    40014,

    common[21],

    common[52],

    common[53],

    common[54]

  },

  {

    1002,

    100,

    7001092,

    300000,

    0,

    40001,

    common[1],

    common[22],

    common[23],

    common[24]

  },

  {

    1003,

    200,

    7001092,

    600000,

    0,

    40003,

    common[12],

    common[25],

    common[26],

    common[27]

  },

  {

    1004,

    300,

    7001092,

    900000,

    0,

    40004,

    common[13],

    common[28],

    common[29],

    common[30],

    1

  },

  {

    1005,

    400,

    7001092,

    1200000,

    0,

    40005,

    common[14],

    common[31],

    common[32],

    common[33]

  },

  {

    1006,

    500,

    7001092,

    1500000,

    0,

    40006,

    common[15],

    common[34],

    common[35],

    common[36],

    1

  },

  {

    1007,

    600,

    7001092,

    1800000,

    0,

    40007,

    common[16],

    common[37],

    common[38],

    common[39]

  },

  {

    1008,

    700,

    7001092,

    2100000,

    0,

    40008,

    common[17],

    common[40],

    common[41],

    common[42],

    1

  },

  {

    1009,

    800,

    7001092,

    2400000,

    0,

    40011,

    common[18],

    common[43],

    common[44],

    common[45]

  },

  {

    1010,

    900,

    7001092,

    2700000,

    0,

    40012,

    common[19],

    common[46],

    common[47],

    common[48],

    1

  },

  {

    1011,

    1000,

    7001092,

    3000000,

    0,

    40013,

    common[20],

    common[49],

    common[50],

    common[51]

  },

  {

    1012,

    1100,

    7001092,

    3000000,

    2000,

    40014,

    common[21],

    common[52],

    common[53],

    common[54]

  },

  {

    1013,

    100,

    7001093,

    100000,

    0,

    40001,

    common[1],

    common[22],

    common[23],

    common[24]

  },

  {

    1014,

    200,

    7001093,

    200000,

    0,

    40003,

    common[12],

    common[25],

    common[26],

    common[27]

  },

  {

    1015,

    300,

    7001093,

    300000,

    0,

    40004,

    common[13],

    common[28],

    common[29],

    common[30],

    1

  },

  {

    1016,

    400,

    7001093,

    400000,

    0,

    40005,

    common[14],

    common[31],

    common[32],

    common[33]

  },

  {

    1017,

    500,

    7001093,

    600000,

    0,

    40006,

    common[15],

    common[34],

    common[35],

    common[36],

    1

  },

  {

    1018,

    600,

    7001093,

    800000,

    0,

    40007,

    common[16],

    common[37],

    common[38],

    common[39]

  },

  {

    1019,

    700,

    7001093,

    1050000,

    0,

    40008,

    common[17],

    common[40],

    common[41],

    common[42],

    1

  },

  {

    1020,

    800,

    7001093,

    1300000,

    0,

    40011,

    common[18],

    common[43],

    common[44],

    common[45]

  },

  {

    1021,

    900,

    7001093,

    1600000,

    0,

    40012,

    common[19],

    common[46],

    common[47],

    common[48],

    1

  },

  {

    1022,

    1000,

    7001093,

    1900000,

    0,

    40013,

    common[20],

    common[49],

    common[50],

    common[51]

  },

  {

    1023,

    1100,

    7001093,

    1900000,

    2000,

    40014,

    common[21],

    common[52],

    common[53],

    common[54]

  }
```
